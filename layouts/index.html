{{ define "main" }}
<div class="page-nav-bar">
  <button class="nav-arrow" id="nav-back" onclick="siteNavBack()" title="Back">&larr;</button>
  <div class="page-nav-title">
    <h1>Home</h1>
  </div>
  <button class="nav-arrow" id="nav-fwd" onclick="siteNavForward()" title="Forward">&rarr;</button>
</div>

<section class="hero">
  <div class="hero-content">
    <h1 class="hero-title">VB Tronic</h1>
    <p class="hero-subtitle">{{ .Site.Params.description }}</p>
    <div class="hero-line"></div>
  </div>
</section>

<div class="search-box">
  <input type="text" id="search-input" placeholder="Search..." autocomplete="off">
</div>

<section class="posts-list" id="search-results" style="display:none;">
  {{ range where .Site.RegularPages.ByDate.Reverse ".Section" "about" }}
  <article class="post-card" data-title="{{ .Title | lower }}" data-description="{{ with .Description }}{{ . | lower }}{{ end }}">
    <a href="{{ .Permalink }}">
      <time class="post-date" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "Jan 2, 2006 15:04" }} CET</time>
      <h2 class="post-title">{{ .Title }}</h2>
      {{ with .Description }}<p class="post-excerpt">{{ . }}</p>{{ end }}
    </a>
  </article>
  {{ end }}
</section>

<p class="no-results" id="no-results" style="display:none;">No results found.</p>

{{ $recent := first 3 (where .Site.RegularPages.ByDate.Reverse ".Section" "about") }}
{{ if $recent }}
<section class="latest-posts">
  <h2 class="latest-posts-heading">Recently Added</h2>
  <div class="latest-posts-grid">
    {{ range $recent }}
    <article class="latest-post-card">
      <a href="{{ .Permalink }}">
        <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "Jan 2, 2006 15:04" }} CET</time>
        <h3>{{ .Title }}</h3>
        {{ with .Description }}<p>{{ . }}</p>{{ end }}
      </a>
    </article>
    {{ end }}
  </div>
</section>
{{ end }}

<section class="about-card" id="about-web">
  <h2 class="about-heading">About This Web</h2>
  <div class="about-body">
    <p>Welcome to <strong>VB Tronic</strong> — a commercial platform and central hub created by Viktor Brunclík. Browse expert articles, seminars, webinars, and digital products, or explore Viktor's portfolio and articles.</p>
  </div>
  <div class="about-links">
    <a href="/about/" class="about-link">About Viktor Brunclík &rarr;</a>
    <a href="/eshop/" class="about-link">E-shop &rarr;</a>
    <a href="/help/" class="about-link">Site Help &rarr;</a>
    <a href="/feedback/" class="about-link">Feedback &rarr;</a>
  </div>
</section>

<script>
(function() {
  var input = document.getElementById('search-input');
  var results = document.getElementById('search-results');
  var noResults = document.getElementById('no-results');
  if (!input || !results) return;

  input.addEventListener('input', function() {
    var query = this.value.toLowerCase().trim();
    var cards = results.querySelectorAll('.post-card');

    if (!query) {
      results.style.display = 'none';
      noResults.style.display = 'none';
      cards.forEach(function(card) { card.style.display = ''; });
      return;
    }

    results.style.display = '';
    var visible = 0;

    cards.forEach(function(card) {
      var title = card.getAttribute('data-title') || '';
      var desc = card.getAttribute('data-description') || '';
      if (title.indexOf(query) !== -1 || desc.indexOf(query) !== -1) {
        card.style.display = '';
        visible++;
      } else {
        card.style.display = 'none';
      }
    });

    noResults.style.display = visible === 0 ? '' : 'none';
  });
})();
</script>
{{ end }}
