<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if not .IsHome }}{{ .Title }} — {{ end }}{{ .Site.Title }}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <script>
  (function() {
    var saved = null;
    try { saved = localStorage.getItem('vbTheme'); } catch(e) {}
    if (!saved) {
      saved = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
    }
    document.documentElement.setAttribute('data-theme', saved);
  })();
  </script>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <a href="/" class="site-logo">vbtronic<span class="accent">.com</span></a>
      <div class="header-right">
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle light/dark theme">
          <svg class="theme-icon theme-icon--sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
          <svg class="theme-icon theme-icon--moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        </button>
        <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false">
          <span class="nav-toggle-bar"></span>
          <span class="nav-toggle-bar"></span>
          <span class="nav-toggle-bar"></span>
        </button>
      </div>
      <nav class="site-nav">
        {{ range .Site.Menus.main }}
          <a href="{{ .URL }}" class="nav-link{{ if $.IsMenuCurrent "main" . }} active{{ end }}">
            {{ if eq .URL "/" }}<svg class="nav-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            {{ else if eq .URL "/about/" }}<svg class="nav-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            {{ else if eq .URL "/help/" }}<svg class="nav-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            {{ else if eq .URL "/feedback/" }}<svg class="nav-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            {{ else if eq .URL "/eshop/" }}<svg class="nav-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
            {{ end }}{{ .Name }}
          </a>
        {{ end }}
      </nav>
    </div>
  </header>

  <main class="site-main">
    <div class="container">
      {{ block "main" . }}{{ end }}
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; {{ now.Year }} Viktor Brunclík. All rights reserved.</p>
      <p class="ai-disclosure">This website and its articles are created by Viktor Brunclík with the help of AI tools Amp and Claude Code.</p>
      <p class="ai-disclosure">Icons on this website are generated by Claude Code (Anthropic). No third-party icon libraries are used.</p>
    </div>
  </footer>
  <script>
  // Hamburger menu toggle
  (function() {
    var toggle = document.querySelector('.nav-toggle');
    var nav = document.querySelector('.site-nav');
    if (!toggle || !nav) return;

    toggle.addEventListener('click', function() {
      var isOpen = nav.classList.toggle('nav-open');
      toggle.classList.toggle('nav-toggle-active', isOpen);
      toggle.setAttribute('aria-expanded', String(isOpen));
    });

    nav.querySelectorAll('.nav-link').forEach(function(link) {
      link.addEventListener('click', function() {
        nav.classList.remove('nav-open');
        toggle.classList.remove('nav-toggle-active');
        toggle.setAttribute('aria-expanded', 'false');
      });
    });
  })();

  // Theme toggle
  (function() {
    var toggle = document.getElementById('theme-toggle');
    if (!toggle) return;

    function getTheme() {
      try { return localStorage.getItem('vbTheme'); } catch(e) { return null; }
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      try { localStorage.setItem('vbTheme', theme); } catch(e) {}
    }

    toggle.addEventListener('click', function() {
      var current = document.documentElement.getAttribute('data-theme') || 'dark';
      setTheme(current === 'dark' ? 'light' : 'dark');
    });

    if (window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', function(e) {
        if (!getTheme()) {
          setTheme(e.matches ? 'light' : 'dark');
        }
      });
    }
  })();

  document.querySelectorAll('.post-content table').forEach(function(table) {
    var wrap = document.createElement('div');
    wrap.className = 'table-wrap';
    table.parentNode.insertBefore(wrap, table);
    wrap.appendChild(table);
  });

  // Site navigation tracking
  (function() {
    var STACK_KEY = 'vbNavStack';
    var POS_KEY = 'vbNavPos';
    var ACTION_KEY = 'vbNavAction';

    var stack = JSON.parse(sessionStorage.getItem(STACK_KEY) || '[]');
    var pos = parseInt(sessionStorage.getItem(POS_KEY), 10);
    var action = sessionStorage.getItem(ACTION_KEY) || 'new';
    var current = location.pathname;

    if (isNaN(pos)) pos = -1;

    if (action === 'back' && pos > 0) {
      pos--;
    } else if (action === 'forward' && pos < stack.length - 1) {
      pos++;
    } else {
      // New navigation — truncate forward entries and push
      pos++;
      stack.length = pos;
      stack.push(current);
    }

    sessionStorage.setItem(STACK_KEY, JSON.stringify(stack));
    sessionStorage.setItem(POS_KEY, String(pos));
    sessionStorage.setItem(ACTION_KEY, 'new');

    var canBack = pos > 0;
    var canFwd = pos < stack.length - 1;

    // Update arrow buttons
    var backBtn = document.getElementById('nav-back');
    var fwdBtn = document.getElementById('nav-fwd');

    if (backBtn) {
      if (!canBack) {
        backBtn.classList.add('disabled');
        backBtn.disabled = true;
      } else {
        backBtn.classList.remove('disabled');
        backBtn.disabled = false;
      }
    }
    if (fwdBtn) {
      if (!canFwd) {
        fwdBtn.classList.add('disabled');
        fwdBtn.disabled = true;
      } else {
        fwdBtn.classList.remove('disabled');
        fwdBtn.disabled = false;
      }
    }

    // Expose navigation functions globally
    window.siteNavBack = function() {
      if (canBack) {
        sessionStorage.setItem(ACTION_KEY, 'back');
        location.href = stack[pos - 1];
      }
    };
    window.siteNavForward = function() {
      if (canFwd) {
        sessionStorage.setItem(ACTION_KEY, 'forward');
        location.href = stack[pos + 1];
      }
    };
  })();
  </script>
</body>
</html>
