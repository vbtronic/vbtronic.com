<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if not .IsHome }}{{ .Title }} — {{ end }}{{ .Site.Title }}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <a href="/" class="site-logo">vbtronic<span class="accent">.com</span></a>
      <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false">
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
      </button>
      <nav class="site-nav">
        {{ range .Site.Menus.main }}
          <a href="{{ .URL }}" class="nav-link{{ if $.IsMenuCurrent "main" . }} active{{ end }}">{{ .Name }}</a>
        {{ end }}
      </nav>
    </div>
  </header>

  <main class="site-main">
    <div class="container">
      {{ block "main" . }}{{ end }}
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; {{ now.Year }} Viktor Brunclík. All rights reserved.</p>
      <p class="ai-disclosure">This website and its articles are created by Viktor Brunclík with the help of AI tools Amp and Claude Code.</p>
    </div>
  </footer>
  <script>
  // Hamburger menu toggle
  (function() {
    var toggle = document.querySelector('.nav-toggle');
    var nav = document.querySelector('.site-nav');
    if (!toggle || !nav) return;

    toggle.addEventListener('click', function() {
      var isOpen = nav.classList.toggle('nav-open');
      toggle.classList.toggle('nav-toggle-active', isOpen);
      toggle.setAttribute('aria-expanded', String(isOpen));
    });

    nav.querySelectorAll('.nav-link').forEach(function(link) {
      link.addEventListener('click', function() {
        nav.classList.remove('nav-open');
        toggle.classList.remove('nav-toggle-active');
        toggle.setAttribute('aria-expanded', 'false');
      });
    });
  })();

  document.querySelectorAll('.post-content table').forEach(function(table) {
    var wrap = document.createElement('div');
    wrap.className = 'table-wrap';
    table.parentNode.insertBefore(wrap, table);
    wrap.appendChild(table);
  });

  // Site navigation tracking
  (function() {
    var STACK_KEY = 'vbNavStack';
    var POS_KEY = 'vbNavPos';
    var ACTION_KEY = 'vbNavAction';

    var stack = JSON.parse(sessionStorage.getItem(STACK_KEY) || '[]');
    var pos = parseInt(sessionStorage.getItem(POS_KEY), 10);
    var action = sessionStorage.getItem(ACTION_KEY) || 'new';
    var current = location.pathname;

    if (isNaN(pos)) pos = -1;

    if (action === 'back' && pos > 0) {
      pos--;
    } else if (action === 'forward' && pos < stack.length - 1) {
      pos++;
    } else {
      // New navigation — truncate forward entries and push
      pos++;
      stack.length = pos;
      stack.push(current);
    }

    sessionStorage.setItem(STACK_KEY, JSON.stringify(stack));
    sessionStorage.setItem(POS_KEY, String(pos));
    sessionStorage.setItem(ACTION_KEY, 'new');

    var canBack = pos > 0;
    var canFwd = pos < stack.length - 1;

    // Update arrow buttons
    var backBtn = document.getElementById('nav-back');
    var fwdBtn = document.getElementById('nav-fwd');

    if (backBtn) {
      if (!canBack) {
        backBtn.classList.add('disabled');
        backBtn.disabled = true;
      } else {
        backBtn.classList.remove('disabled');
        backBtn.disabled = false;
      }
    }
    if (fwdBtn) {
      if (!canFwd) {
        fwdBtn.classList.add('disabled');
        fwdBtn.disabled = true;
      } else {
        fwdBtn.classList.remove('disabled');
        fwdBtn.disabled = false;
      }
    }

    // Expose navigation functions globally
    window.siteNavBack = function() {
      if (canBack) {
        sessionStorage.setItem(ACTION_KEY, 'back');
        location.href = stack[pos - 1];
      }
    };
    window.siteNavForward = function() {
      if (canFwd) {
        sessionStorage.setItem(ACTION_KEY, 'forward');
        location.href = stack[pos + 1];
      }
    };
  })();
  </script>
</body>
</html>
